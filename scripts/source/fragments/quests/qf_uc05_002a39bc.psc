ScriptName Fragments:Quests:QF_UC05_002A39BC Extends Quest Const hidden

;-- Variables ---------------------------------------

;-- Properties --------------------------------------
Scene Property UC04_MacIntyreIntro_Scene150 Auto Const mandatory
ReferenceAlias Property Alias_DeputyMacIntyre Auto Const mandatory
Message Property UC04_DEBUG_DataslatesDontWork Auto Const mandatory
Scene Property UC04_RadcliffIIntro_Scene300 Auto Const mandatory
ObjectReference Property DebugMarker01 Auto Const mandatory
ObjectReference Property DebugMarker02 Auto Const
ObjectReference Property DebugMarker10 Auto Const
Message Property UC05_DEBUG_Powerswitch01 Auto Const mandatory
ReferenceAlias Property Alias_VaruunMainDoor Auto Const mandatory
ReferenceAlias Property Alias_VaruunBasementDoor Auto Const mandatory
Scene Property UC05_Codin_Warning Auto Const mandatory
ReferenceAlias Property Alias_VaruunSafeRoomDoor Auto Const mandatory
ReferenceAlias Property Alias_Codin Auto Const mandatory
Scene Property UC05_Codin_Intro_Scene710 Auto Const mandatory
Scene Property UC05_Codin_LoopingIntercom Auto Const mandatory
Message Property UC05_DEBUG_CodinGameplayMessage Auto Const mandatory
Key Property UC05_CodeMachineKey_Varuun Auto Const mandatory
Book Property UC05_FreestarArchivalCode Auto Const mandatory
ReferenceAlias Property Alias_FreestarDossier Auto Const mandatory
ReferenceAlias Property Alias_FreestarCodePiece Auto Const mandatory
ReferenceAlias Property Alias_VaruunCodePiece Auto Const mandatory
ReferenceAlias Property Alias_UCCodePiece Auto Const mandatory
Scene Property UC05_930_ArchiveScene Auto Const mandatory
Scene Property UC05_960_CodesVerified Auto Const mandatory
ReferenceAlias Property Alias_TerrormorphData Auto Const mandatory
Scene Property UC05_970_CodinHadrianAttract Auto Const mandatory
ObjectReference Property HadrianTeleportMarker Auto Const mandatory
ReferenceAlias Property Alias_Hadrian Auto Const mandatory
ReferenceAlias Property Alias_CameronWhite Auto Const mandatory
ReferenceAlias Property Alias_Radcliff Auto Const mandatory
ObjectReference Property WhiteTeleportMarker Auto Const mandatory
Key Property UC05_CodeMachineKey_Freestar Auto Const mandatory
Scene Property UC05_507_CodinPowerScene Auto Const mandatory
Message Property UC05_DEBUG_Powerswitch02 Auto Const mandatory
Quest Property UC06 Auto Const mandatory
Weapon Property UC05_Reward_Regulator Auto Const mandatory
Key Property UC05_Freestar_UtilityAccessKey Auto Const mandatory
ReferenceAlias Property Alias_VaruunPowerSwitch02 Auto Const mandatory
ReferenceAlias Property Alias_VaruunPowerSwitch03 Auto Const mandatory
ReferenceAlias Property Alias_VaruunPowerSwitch04 Auto Const mandatory
Scene Property UC05_500_Balmor_IntroIntercom Auto Const mandatory
ReferenceAlias Property Alias_VEPowerSwitchEnableMarker01 Auto Const mandatory
ReferenceAlias Property Alias_VEPowerSwitchEnableMarker02 Auto Const mandatory
ReferenceAlias Property Alias_VEPowerSwitchEnableMarker03 Auto Const mandatory
ReferenceAlias Property Alias_VEMasterEnableMarker Auto Const mandatory
Scene Property UC05_510_FirstPowerSwitchThrown Auto Const mandatory
Book Property UC05_FreestarSecurityWarning Auto Const mandatory
ReferenceAlias Property Alias_FSE_SecurityNotation Auto Const mandatory
MiscObject Property Credits Auto Const mandatory
GlobalVariable Property UC05_PlayerIsUCCitizen Auto Const mandatory
GlobalVariable Property NPCDemandMoney_Large Auto Const mandatory
ReferenceAlias Property Alias_AAVaultDoor Auto Const mandatory
ReferenceAlias Property Alias_IntercomSoundMarker Auto Const mandatory
Perk Property UC_CitizenVendorDiscount_Rank01 Auto Const mandatory
GlobalVariable Property UC05_FreestarResultGlobal Auto Const mandatory
GlobalVariable Property UC05_VaruunResultGlobal Auto Const mandatory
GlobalVariable Property UC05_PlayerCausedIncident Auto Const mandatory
GlobalVariable Property UC05_PlayerCaughtSnoopingFSE Auto Const mandatory
Key Property UC05_Freestar_EmbassyAccessCard Auto Const mandatory
Key Property UC05_Varuun_EmbassyAccessKey Auto Const mandatory
Message Property UC05_DEBUG_AccessingListeningDevice Auto Const mandatory
Scene Property UC04_RadcliffMain_Scene355_HeadToCodeMachine Auto Const mandatory
RefCollectionAlias Property Alias_VaruunSHIVAs Auto Const mandatory
GlobalVariable Property UC05_PlayerEscapedTroubleThroughBlackmail Auto Const mandatory
Key Property UC05_ArmisticeArchiveAccessCard Auto Const mandatory
ReferenceAlias Property Alias_MinisterToNATDoor Auto Const mandatory
Scene Property UC05_520_BalmorPowerBoxScene02 Auto Const mandatory
Scene Property UC05_540_BalmorPowerBoxScene03 Auto Const mandatory
Scene Property UC05_940_ArchiveMonitorInstructions Auto Const mandatory
ReferenceAlias Property Alias_UC02_DefenseSystem Auto Const mandatory
Key Property UC05_PlayerCitizenshipID01 Auto Const mandatory
GlobalVariable Property UC05_HadrianSandboxing_PostUC05 Auto Const mandatory
Message Property UC05_DEBUG_EnterVenomTreeRoom Auto Const mandatory
ReferenceAlias Property Alias_ChiefYasin Auto Const mandatory
Scene Property UC05_519_SecondIntercomTriggered Auto Const mandatory
Scene Property UC05_539_ThirdIntercomTriggered Auto Const mandatory
Faction Property PlayerEnemyFaction Auto Const mandatory
Perk Property FactionUnitedColoniesPerk Auto Const mandatory
GlobalVariable Property UC05_FreestarObserversAccepted Auto Const mandatory
ActorValue Property UC04_Foreknowledge_OpenedArchivesAV Auto Const mandatory
Scene Property UC05_110_Hadrian_IntroScene Auto Const mandatory
GlobalVariable Property UC05_AndrejaBalmorDiscussedPlayer Auto Const mandatory
GlobalVariable Property UC05_AndrejaPresentForBalmorDiscussion Auto Const mandatory
ReferenceAlias Property Alias_Andreja Auto Const mandatory
ReferenceAlias Property Alias_Companion Auto Const mandatory
GlobalVariable Property COM_InterjectionDistance Auto Const mandatory
Scene Property UC05_796_Balmor_CollectCodePiece Auto Const mandatory
ActorValue Property UC05_Foreknowledge_RadcliffWantsOversightAV Auto Const mandatory
ReferenceAlias Property Alias_SecondIntercom Auto Const mandatory
ReferenceAlias Property Alias_ThirdIntercom Auto Const mandatory
ReferenceAlias Property Alias_ActiveIntercom Auto Const mandatory
ReferenceAlias Property Alias_VaruunIntercom01 Auto Const mandatory
Scene Property UC05_507_BalmorPowerScene Auto Const mandatory
Quest Property UC05_Realty_Misc Auto Const mandatory
wwiseevent Property OBJ_Server_Room_Light_Switch_Power_On_Play Auto Const mandatory
Quest Property pUC_NA_CL_PostTerrormorphAttackScene Auto Const mandatory
ReferenceAlias Property Alias_FSECodeMachine Auto Const mandatory
Faction Property PlayerFaction Auto Const mandatory
Faction Property FreestarEmbassyFaction Auto Const mandatory
ReferenceAlias Property Alias_ModelA_Ambush01 Auto Const mandatory
ReferenceAlias Property Alias_ModelA_Ambush02 Auto Const mandatory
ReferenceAlias Property Alias_ModelA_Ambush03 Auto Const mandatory
wwiseevent Property WwiseEvent_OBJ_Server_Room_Light_Switch_Power_On Auto Const mandatory
wwiseevent Property WwiseEvent_OBJ_Server_Room_Power_On_A_Vent_LP Auto Const mandatory
ReferenceAlias Property Alias_VaruunPowerSwitch01 Auto Const mandatory
Float Property LightDelay Auto Const mandatory
Float Property VentDelay Auto Const mandatory
RefCollectionAlias Property Alias_HostileAI Auto Const mandatory
ReferenceAlias Property Alias_VentSoundMarker02 Auto Const mandatory
ReferenceAlias Property Alias_VentSoundMarker04 Auto Const mandatory
ReferenceAlias Property Alias_Cabinet18 Auto Const mandatory
wwiseevent Property WwiseEvent_OBJ_Server_Room_Unlock_Door Auto Const mandatory
wwiseevent Property WwiseEvent_QST_UC05_Unlock_Door_Success_Play Auto Const mandatory
ReferenceAlias Property Alias_ModelA_Ambush04 Auto Const mandatory
ReferenceAlias Property Alias_ModelA_Ambush05 Auto Const mandatory
ReferenceAlias Property Alias_ModelA_Ambush06 Auto Const mandatory
ReferenceAlias Property Alias_PodRobot Auto Const mandatory
Keyword Property BlockPlayerActivation Auto Const mandatory
ReferenceAlias Property Alias_VaruunCodeMachine Auto Const mandatory
LeveledItem Property LL_Weapon_Reward_UC05_Ambassador Auto Const mandatory
ReferenceAlias Property Alias_HadrianShip_RHQ Auto Const mandatory
ReferenceAlias Property Alias_FallingRobot Auto Const mandatory
ReferenceAlias Property Alias_CubicleRobot01 Auto Const mandatory
ReferenceAlias Property Alias_CubicleRobot02 Auto Const mandatory
ReferenceAlias Property Alias_CubicleRobot03 Auto Const mandatory
ReferenceAlias Property Alias_PrayerCircle01 Auto Const mandatory
ReferenceAlias Property Alias_PrayerCircle02 Auto Const mandatory
ReferenceAlias Property Alias_PrayerCircle03 Auto Const mandatory
ReferenceAlias Property Alias_FallingRobotMarker Auto Const mandatory
ReferenceAlias Property Alias_VaruunCodeReceptacle Auto Const mandatory
ReferenceAlias Property Alias_FreestarCodeReceptacle Auto Const mandatory
ReferenceAlias Property Alias_UCCodeReceptacle Auto Const mandatory
Key Property UC05_Freestar_ElevatorKey Auto Const mandatory
ReferenceAlias Property Alias_RobotStairs Auto Const mandatory
ReferenceAlias Property Alias_UC05_DustSpillMSTT Auto Const mandatory
wwiseevent Property WwiseEvent_QST_UC05_JumpScare_RobotFalling_Leaves Auto Const mandatory
Explosion Property UC05_HavokExplosion Auto Const mandatory
ReferenceAlias Property Alias_BoxRobot Auto Const mandatory
ReferenceAlias Property Alias_BoxRobot01 Auto Const mandatory
ObjectReference Property DebugMarker11 Auto Const mandatory
ReferenceAlias Property Alias_MAST_EmergencyDoor Auto Const mandatory
ReferenceAlias Property Alias_MASTWorkerMale04 Auto Const mandatory
GlobalVariable Property UC05_RadcliffBribeCredits Auto Const mandatory
RefCollectionAlias Property Alias_VenomTreeHaze_Group01 Auto Const mandatory
RefCollectionAlias Property Alias_VenomTreeHaze_Group02 Auto Const mandatory
ReferenceAlias Property Alias_FreestarGuard_RadcliffeOffice Auto Const mandatory
ReferenceAlias Property Alias_ModelA_Ambush00 Auto Const mandatory
ReferenceAlias Property Alias_ModelA_Ambush07 Auto Const mandatory
ReferenceAlias Property Alias_TrespassTrigger Auto Const mandatory
Keyword Property UC05_FSE_TrespassLink Auto Const mandatory
LeveledItem Property LL_Quest_Reward_Credits_Faction_03_Large Auto Const mandatory
ReferenceAlias Property Alias_FSECodeMachineRoomDoor Auto Const mandatory

;-- Functions ---------------------------------------

Function Fragment_Stage_0001_Item_00()
  Alias_ChiefYasin.GetRef().Disable(False)
  Alias_Hadrian.GetRef().Enable(False)
  Game.GetPlayer().MoveTo(DebugMarker01, 0.0, 0.0, 0.0, True, False)
  Alias_MinisterToNATDoor.GetRef().Unlock(False)
EndFunction

Function Fragment_Stage_0002_Item_00()
  Alias_Hadrian.GetRef().Enable(False)
  Alias_Radcliff.GetRef().Enable(False)
  Alias_ChiefYasin.GetRef().Disable(False)
  Alias_MinisterToNATDoor.GetRef().Unlock(False)
  Self.SetStage(190)
  Self.SetStage(201)
  Self.SetStage(202)
  Self.SetStage(203)
  Self.SetStage(210)
  Self.SetStage(220)
  Self.SetStage(300)
  Utility.Wait(1.0)
  Game.GetPlayer().MoveTo(DebugMarker02, 0.0, 0.0, 0.0, True, False)
  Utility.Wait(1.0)
  Self.SetObjectiveCompleted(100, True)
EndFunction

Function Fragment_Stage_0010_Item_00()
  Alias_Hadrian.GetRef().Enable(False)
  Alias_ChiefYasin.GetRef().Disable(False)
  Alias_MinisterToNATDoor.GetRef().Unlock(False)
  UC05_FreestarResultGlobal.SetValue(1.0)
  Self.SetStage(190)
  Self.SetStage(450)
  Self.SetStage(495)
  Self.SetStage(300)
  Self.SetObjectiveCompleted(100, True)
  Game.GetPlayer().MoveTo(DebugMarker10, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0011_Item_00()
  Alias_Hadrian.GetRef().Enable(False)
  Alias_ChiefYasin.GetRef().Disable(False)
  Alias_MinisterToNATDoor.GetRef().Unlock(False)
  UC05_FreestarResultGlobal.SetValue(1.0)
  Self.SetStage(190)
  Self.SetStage(450)
  Self.SetStage(495)
  Self.SetStage(300)
  Self.SetStage(500)
  Self.SetStage(510)
  Self.SetStage(520)
  Self.SetStage(540)
  Self.SetStage(600)
  Self.SetStage(700)
  Alias_HostileAI.KillAll(None)
  Alias_PodRobot.GetActorRef().Kill(None)
  Alias_PrayerCircle01.GetActorRef().Kill(None)
  Alias_PrayerCircle02.GetActorRef().Kill(None)
  Alias_PrayerCircle03.GetActorRef().Kill(None)
  Self.SetObjectiveCompleted(100, True)
  Self.SetObjectiveCompleted(300, True)
  Self.SetObjectiveCompleted(352, True)
  Self.SetObjectiveCompleted(510, True)
  Self.SetObjectiveCompleted(515, True)
  Game.GetPlayer().MoveTo(DebugMarker11, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0015_Item_00()
  Alias_Hadrian.GetRef().Enable(False)
  Alias_ChiefYasin.GetRef().Disable(False)
  Game.GetPlayer().AddItem(Alias_VaruunCodePiece.GetRef() as Form, 1, False)
  Game.GetPlayer().AddItem(Alias_FreestarCodePiece.GetRef() as Form, 1, False)
  Alias_MinisterToNATDoor.GetRef().Unlock(False)
  Self.SetStage(190)
  Self.SetStage(900)
  Self.SetObjectiveCompleted(100, True)
  Game.GetPlayer().MoveTo(DebugMarker01, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0017_Item_00()
  Alias_Hadrian.GetRef().Enable(False)
  Alias_ChiefYasin.GetRef().Disable(False)
  Alias_MinisterToNATDoor.GetRef().Unlock(False)
  Self.SetStage(190)
  Self.SetStage(900)
  Self.SetStage(925)
  Self.SetStage(970)
  Self.SetObjectiveCompleted(100, True)
  Self.SetObjectiveCompleted(925, True)
  Self.SetObjectiveCompleted(900, True)
  Game.GetPlayer().MoveTo(DebugMarker01, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0020_Item_00()
  Alias_FSECodeMachine.GetRef().BlockActivation(False, False)
EndFunction

Function Fragment_Stage_0040_Item_00()
  Alias_TrespassTrigger.GetRef().SetLinkedRef(None, UC05_FSE_TrespassLink, True)
EndFunction

Function Fragment_Stage_0100_Item_00()
  Alias_DeputyMacIntyre.GetActorRef().EvaluatePackage(False)
  Self.SetObjectiveDisplayed(100, True, False)
  Alias_VaruunSHIVAs.SetUnconscious(True)
  Alias_FSECodeMachine.GetRef().BlockActivation(True, False)
  Self.SetActive(True)
EndFunction

Function Fragment_Stage_0110_Item_00()
  UC05_110_Hadrian_IntroScene.Start()
EndFunction

Function Fragment_Stage_0150_Item_00()
  Quest __temp = Self as Quest
  uc05_questscript kmyQuest = __temp as uc05_questscript
  UC04_MacIntyreIntro_Scene150.Start()
  kmyQuest.OpenShutters()
EndFunction

Function Fragment_Stage_0190_Item_00()
  Alias_DeputyMacIntyre.GetActorRef().EvaluatePackage(False)
EndFunction

Function Fragment_Stage_0210_Item_00()
  Game.GetPlayer().AddItem(UC05_Freestar_EmbassyAccessCard as Form, 1, False)
EndFunction

Function Fragment_Stage_0211_Item_00()
  Actor PlayACT = Game.GetPlayer()
  PlayACT.AddItem(Alias_FSE_SecurityNotation.GetRef() as Form, 1, False)
  PlayACT.AddItem(LL_Quest_Reward_Credits_Faction_03_Large as Form, 1, False)
EndFunction

Function Fragment_Stage_0215_Item_00()
  If Self.IsObjectiveDisplayed(312)
    Self.SetObjectiveCompleted(312, True)
  EndIf
  If Self.GetStageDone(317)
    Self.SetStage(381)
  EndIf
EndFunction

Function Fragment_Stage_0220_Item_00()
  Game.GetPlayer().AddItem(UC05_Varuun_EmbassyAccessKey as Form, 1, False)
EndFunction

Function Fragment_Stage_0300_Item_00()
  Quest __temp = Self as Quest
  uc04_togglehallscreens kmyQuest = __temp as uc04_togglehallscreens
  Self.SetObjectiveCompleted(100, True)
  Self.SetObjectiveDisplayedAtTop(300)
  Actor CamACT = Alias_CameronWhite.GetActorRef()
  CamACT.Enable(False)
  CamACT.MoveTo(WhiteTeleportMarker, 0.0, 0.0, 0.0, True, False)
  CamACT.EvaluatePackage(False)
  Actor RadACT = Alias_Radcliff.GetActorRef()
  RadACT.Enable(False)
  RadACT.EvaluatePackage(False)
  Alias_IntercomSoundMarker.GetRef().Enable(False)
  Game.GetPlayer().AddItem(UC05_Freestar_ElevatorKey as Form, 1, True)
EndFunction

Function Fragment_Stage_0307_Item_00()
  If !Self.GetStageDone(335)
    UC04_RadcliffIIntro_Scene300.Start()
  EndIf
  Alias_MASTWorkerMale04.GetRef().Enable(False)
EndFunction

Function Fragment_Stage_0310_Item_00()
  Alias_CameronWhite.GetActorRef().EvaluatePackage(False)
  Utility.Wait(1.0)
  Alias_FreestarGuard_RadcliffeOffice.GetActorRef().EvaluatePackage(False)
EndFunction

Function Fragment_Stage_0317_Item_00()
  If !Self.GetStageDone(349) && !Self.GetStageDone(345)
    If !Self.GetStageDone(340)
      Self.SetObjectiveDisplayed(310, True, False)
      If !Self.GetStageDone(370)
        Self.SetObjectiveDisplayed(311, True, False)
      EndIf
    EndIf
    If Self.GetStageDone(211)
      If Self.GetStageDone(215)
        Self.SetStage(381)
      Else
        Self.SetObjectiveDisplayed(312, True, False)
      EndIf
    EndIf
    If !Self.GetStageDone(320) && !Self.GetStageDone(330)
      Self.SetObjectiveDisplayed(300, True, True)
    EndIf
  EndIf
EndFunction

Function Fragment_Stage_0335_Item_00()
  Self.SetStage(385)
EndFunction

Function Fragment_Stage_0340_Item_00()
  If !Self.IsObjectiveCompleted(300) && !Self.IsObjectiveFailed(300)
    Self.SetObjectiveDisplayed(300, False, False)
  EndIf
  If !Self.IsObjectiveCompleted(310)
    Self.SetObjectiveDisplayed(310, False, False)
  EndIf
  If !Self.IsObjectiveCompleted(311)
    Self.SetObjectiveDisplayed(311, False, False)
  EndIf
  If !Self.IsObjectiveCompleted(312)
    Self.SetObjectiveDisplayed(312, False, False)
  EndIf
  If !Self.GetStageDone(448)
    Self.SetObjectiveDisplayed(340, True, False)
  EndIf
EndFunction

Function Fragment_Stage_0347_Item_00()
  Self.SetStage(349)
  Self.SetStage(350)
EndFunction

Function Fragment_Stage_0348_Item_00()
  Self.SetObjectiveCompleted(300, True)
  Self.SetObjectiveDisplayed(348, True, False)
EndFunction

Function Fragment_Stage_0350_Item_00()
  Self.SetStage(40)
  Alias_FSECodeMachineRoomDoor.GetRef().Unlock(False)
  UC04_RadcliffMain_Scene355_HeadToCodeMachine.Start()
  Game.GetPlayer().SetValue(UC05_Foreknowledge_RadcliffWantsOversightAV, 1.0)
  Self.SetObjectiveCompleted(300, True)
  Self.SetObjectiveCompleted(351, True)
  If Self.IsObjectiveDisplayed(310)
    Self.SetObjectiveDisplayed(310, False, False)
  EndIf
  If Self.IsObjectiveDisplayed(311)
    Self.SetObjectiveDisplayed(311, False, False)
  EndIf
  If Self.IsObjectiveDisplayed(312)
    Self.SetObjectiveDisplayed(312, False, False)
  EndIf
  If Self.IsObjectiveDisplayed(370)
    Self.SetObjectiveDisplayed(370, False, False)
  EndIf
  If Self.IsObjectiveDisplayed(375)
    Self.SetObjectiveDisplayed(375, False, False)
  EndIf
  Self.SetObjectiveCompleted(340, True)
  Self.SetObjectiveDisplayed(350, True, False)
  Alias_FSECodeMachine.GetRef().SetFactionOwner(PlayerFaction, False)
EndFunction

Function Fragment_Stage_0351_Item_00()
  Self.SetObjectiveCompleted(348, True)
  Self.SetObjectiveDisplayed(351, True, False)
EndFunction

Function Fragment_Stage_0352_Item_00()
  Self.SetStage(350)
  Game.GetPlayer().AddItem(Credits as Form, UC05_RadcliffBribeCredits.GetValueInt(), False)
EndFunction

Function Fragment_Stage_0353_Item_00()
  Game.GetPlayer().AddItem(LL_Weapon_Reward_UC05_Ambassador as Form, 1, False)
EndFunction

Function Fragment_Stage_0355_Item_00()
  Self.SetStage(350)
EndFunction

Function Fragment_Stage_0370_Item_00()
  Self.SetObjectiveCompleted(311, True)
  Self.SetObjectiveDisplayed(370, True, False)
  Alias_CameronWhite.GetActorRef().EvaluatePackage(False)
EndFunction

Function Fragment_Stage_0375_Item_00()
  Self.SetObjectiveCompleted(370, True)
  Self.SetObjectiveDisplayed(375, True, False)
EndFunction

Function Fragment_Stage_0377_Item_00()
  Game.GetPlayer().RemoveItem(Credits as Form, NPCDemandMoney_Large.GetValueInt(), False, None)
EndFunction

Function Fragment_Stage_0380_Item_00()
  Game.GetPlayer().AddItem(UC05_Freestar_UtilityAccessKey as Form, 1, False)
  Self.SetStage(379)
  If !Self.IsObjectiveDisplayed(310)
    Self.SetObjectiveDisplayed(310, True, False)
  EndIf
  Self.SetObjectiveCompleted(375, True)
EndFunction

Function Fragment_Stage_0381_Item_00()
  Self.SetStage(379)
EndFunction

Function Fragment_Stage_0390_Item_00()
  Self.SetStage(450)
EndFunction

Function Fragment_Stage_0395_Item_00()
  ObjectReference CodeMachineRef = Alias_FSECodeMachine.GetRef()
  ObjectReference Radcliff = Alias_Radcliff.GetRef()
  CodeMachineRef.AddKeyword(BlockPlayerActivation)
  CodeMachineRef.PlayAnimation("Play01")
EndFunction

Function Fragment_Stage_0396_Item_00()
  Alias_FSECodeMachine.GetRef().Activate(Alias_Radcliff.GetRef(), False)
EndFunction

Function Fragment_Stage_0447_Item_00()
  Self.SetStage(449)
  If Self.IsObjectiveDisplayed(311)
    Self.SetObjectiveFailed(311, True)
  EndIf
  If Self.IsObjectiveDisplayed(370)
    Self.SetObjectiveFailed(370, True)
  EndIf
EndFunction

Function Fragment_Stage_0448_Item_00()
  Self.SetStage(449)
  If !Self.GetStageDone(450)
    If Self.IsObjectiveDisplayed(300)
      Self.SetObjectiveFailed(300, True)
    EndIf
    If Self.IsObjectiveDisplayed(310)
      Self.SetObjectiveFailed(310, True)
    EndIf
    If Self.IsObjectiveDisplayed(311)
      Self.SetObjectiveFailed(311, True)
    EndIf
    If Self.IsObjectiveDisplayed(312)
      Self.SetObjectiveFailed(312, True)
    EndIf
    If Self.IsObjectiveDisplayed(340)
      Self.SetObjectiveFailed(340, True)
    EndIf
    If Self.IsObjectiveDisplayed(348)
      Self.SetObjectiveFailed(348, True)
    EndIf
    If Self.IsObjectiveDisplayed(350)
      Self.SetObjectiveFailed(350, True)
    EndIf
    If Self.IsObjectiveDisplayed(351)
      Self.SetObjectiveFailed(351, True)
    EndIf
    Self.SetObjectiveDisplayed(352, True, False)
  EndIf
EndFunction

Function Fragment_Stage_0449_Item_00()
  If Self.IsObjectiveDisplayed(311)
    Self.SetObjectiveFailed(311, True)
  EndIf
  If Self.IsObjectiveDisplayed(370)
    Self.SetObjectiveFailed(370, True)
  EndIf
  If Self.IsObjectiveDisplayed(375)
    Self.SetObjectiveFailed(375, True)
  EndIf
EndFunction

Function Fragment_Stage_0450_Item_00()
  Self.SetObjectiveCompleted(300, True)
  Self.SetObjectiveCompleted(301, True)
  Self.SetObjectiveCompleted(310, True)
  If !Self.IsObjectiveCompleted(311) && Self.IsObjectiveDisplayed(311)
    Self.SetObjectiveDisplayed(311, False, False)
  EndIf
  Self.SetObjectiveCompleted(340, True)
  Self.SetObjectiveCompleted(350, True)
  Self.SetObjectiveCompleted(352, True)
  Game.GetPlayer().AddItem(Alias_FreestarCodePiece.GetRef() as Form, 1, False)
  Alias_FSECodeMachine.GetRef().AddKeyword(BlockPlayerActivation)
  If Self.GetStageDone(810)
    Self.SetStage(900)
  Else
    Self.SetObjectiveDisplayed(500, True, False)
  EndIf
  If Self.GetStageDone(350)
    If Self.GetStageDone(345)
      UC05_FreestarResultGlobal.SetValue(2.0)
    ElseIf Self.GetStageDone(320)
      UC05_FreestarResultGlobal.SetValue(1.0)
    Else
      UC05_FreestarResultGlobal.SetValue(3.0)
    EndIf
  Else
    UC05_FreestarResultGlobal.SetValue(3.0)
  EndIf
  If Self.GetStageDone(449) || UC05_PlayerCaughtSnoopingFSE.GetValue() >= 1.0
    If Self.GetStageDone(345) && Self.GetStageDone(350) && !Self.GetStageDone(448)
      UC05_PlayerEscapedTroubleThroughBlackmail.SetValue(1.0)
    EndIf
  EndIf
EndFunction

Function Fragment_Stage_0486_Item_00()
  Actor AmbushRobot = Alias_ModelA_Ambush07.GetActorRef()
  AmbushRobot.SetUnconscious(False)
EndFunction

Function Fragment_Stage_0487_Item_00()
  Actor AmbushRobot = Alias_ModelA_Ambush04.GetActorRef()
  AmbushRobot.SetUnconscious(False)
EndFunction

Function Fragment_Stage_0488_Item_00()
  Alias_BoxRobot.GetRef().PlaceAtMe(UC05_HavokExplosion as Form, 1, False, False, True, None, None, True)
EndFunction

Function Fragment_Stage_0489_Item_00()
  ObjectReference RobotRef = Alias_RobotStairs.GetRef()
  RobotRef.EnableNoWait(False)
  RobotRef.ApplyHavokImpulse(0.0, -2.0, 0.5, 3.0)
EndFunction

Function Fragment_Stage_0490_Item_00()
  Alias_PrayerCircle01.GetActorRef().SetUnconscious(False)
  Alias_PrayerCircle02.GetActorRef().SetUnconscious(False)
  Alias_PrayerCircle03.GetActorRef().SetUnconscious(False)
EndFunction

Function Fragment_Stage_0491_Item_00()
  Alias_CubicleRobot01.GetActorRef().SetUnconscious(False)
  Alias_CubicleRobot02.GetActorRef().SetUnconscious(False)
  Alias_CubicleRobot03.GetActorRef().SetUnconscious(False)
EndFunction

Function Fragment_Stage_0492_Item_00()
  ObjectReference RobotRef = Alias_FallingRobot.GetRef()
  ObjectReference MarkerRef = Alias_FallingRobotMarker.GetRef()
  WwiseEvent_QST_UC05_JumpScare_RobotFalling_Leaves.Play(MarkerRef, None, None)
  Utility.Wait(0.5)
  RobotRef.MoveTo(MarkerRef, 0.0, 0.0, 0.0, True, False)
  RobotRef.SetAngle(180.0, 180.0, 180.0)
  RobotRef.ApplyHavokImpulse(-1.0, 0.0, 0.0, 0.5)
  Alias_UC05_DustSpillMSTT.GetRef().Disable(False)
EndFunction

Function Fragment_Stage_0493_Item_00()
  Actor AmbushRobot = Alias_ModelA_Ambush06.GetActorRef()
  AmbushRobot.SetUnconscious(False)
EndFunction

Function Fragment_Stage_0494_Item_00()
  Actor AmbushRobot = Alias_ModelA_Ambush05.GetActorRef()
  AmbushRobot.SetUnconscious(False)
EndFunction

Function Fragment_Stage_0496_Item_00()
  Alias_ModelA_Ambush01.GetActorRef().SetUnconscious(False)
EndFunction

Function Fragment_Stage_0497_Item_00()
  Alias_ModelA_Ambush02.GetActorRef().SetUnconscious(False)
EndFunction

Function Fragment_Stage_0498_Item_00()
  Alias_ModelA_Ambush03.GetActorRef().SetUnconscious(False)
EndFunction

Function Fragment_Stage_0499_Item_00()
  Actor AmbushRobot = Alias_ModelA_Ambush00.GetActorRef()
  AmbushRobot.SetUnconscious(False)
EndFunction

Function Fragment_Stage_0500_Item_00()
  UC05_500_Balmor_IntroIntercom.Start()
  Self.SetObjectiveDisplayed(501, True, False)
  Self.SetObjectiveDisplayed(500, False, False)
  (Alias_PodRobot.GetRef() as robotpodscript).SendRobottoPod()
EndFunction

Function Fragment_Stage_0505_Item_00()
  Quest __temp = Self as Quest
  uc05_questscript kmyQuest = __temp as uc05_questscript
  kmyQuest.UpdateActiveIntercom(Self as ScriptObject, False, None, -1)
EndFunction

Function Fragment_Stage_0507_Item_00()
  UC05_507_CodinPowerScene.Start()
  Self.SetObjectiveCompleted(501, True)
  Self.SetObjectiveDisplayed(507, True, False)
EndFunction

Function Fragment_Stage_0510_Item_00()
  Self.SetObjectiveCompleted(501, True)
  Self.SetStage(505)
  Self.SetStage(507)
EndFunction

Function Fragment_Stage_0510_Item_01()
  Quest __temp = Self as Quest
  uc05_questscript kmyQuest = __temp as uc05_questscript
  kmyQuest.IncrementIntercomState(1)
  ObjectReference DoorRef = Alias_VaruunMainDoor.GetRef()
  WwiseEvent_OBJ_Server_Room_Unlock_Door.Play(DoorRef, None, None)
  DoorRef.Unlock(False)
  Alias_VEPowerSwitchEnableMarker01.GetRef().Enable(False)
  Self.SetObjectiveCompleted(501, True)
  Self.SetObjectiveCompleted(507, True)
  Self.SetObjectiveDisplayed(510, False, False)
  Self.SetObjectiveDisplayed(515, True, False)
  UC05_507_BalmorPowerScene.Stop()
  UC05_510_FirstPowerSwitchThrown.Start()
  WwiseEvent_OBJ_Server_Room_Light_Switch_Power_On.Play(Alias_VaruunPowerSwitch01.GetRef(), None, None)
EndFunction

Function Fragment_Stage_0515_Item_00()
  Quest __temp = Self as Quest
  uc05_questscript kmyQuest = __temp as uc05_questscript
  kmyQuest.UpdateActiveIntercom(Self as ScriptObject, True, None, -1)
  Utility.Wait(0.5)
  Self.SetObjectiveCompleted(515, True)
  Self.SetObjectiveDisplayed(510, True, False)
  Self.SetStage(499)
EndFunction

Function Fragment_Stage_0518_Item_00()
  Alias_VenomTreeHaze_Group01.DisableAll(False)
EndFunction

Function Fragment_Stage_0519_Item_00()
  Alias_SecondIntercom.ForceRefTo(Alias_ActiveIntercom.GetRef())
  UC05_519_SecondIntercomTriggered.Start()
  Self.SetObjectiveDisplayed(510, False, False)
  Self.SetObjectiveDisplayed(519, True, False)
EndFunction

Function Fragment_Stage_0520_Item_00()
  Quest __temp = Self as Quest
  uc05_questscript kmyQuest = __temp as uc05_questscript
  Self.SetObjectiveCompleted(519, True)
  Self.SetObjectiveDisplayed(510, True, False)
  kmyQuest.IncrementIntercomState(1)
  kmyQuest.UpdateActiveIntercom(Self as ScriptObject, True, Alias_VaruunPowerSwitch02, 510)
  WwiseEvent_OBJ_Server_Room_Light_Switch_Power_On.Play(Alias_VaruunPowerSwitch02.GetRef(), None, None)
  Alias_VEPowerSwitchEnableMarker02.GetRef().Enable(False)
  If !Self.GetStageDone(540)
    UC05_520_BalmorPowerBoxScene02.Start()
  Else
    UC05_540_BalmorPowerBoxScene03.Start()
  EndIf
  (Alias_PodRobot.GetRef() as robotpodscript).WakeRobotFromPod()
  Utility.Wait(LightDelay)
  Int instance1 = WwiseEvent_OBJ_Server_Room_Power_On_A_Vent_LP.Play(Alias_VentSoundMarker02.GetRef(), None, None)
  kmyQuest.RemoveHaze(1)
  Utility.Wait(VentDelay)
  wwiseevent.StopInstance(instance1)
EndFunction

Function Fragment_Stage_0529_Item_00()
  Self.SetObjectiveDisplayed(510, False, False)
  Self.SetObjectiveDisplayed(529, True, False)
EndFunction

Function Fragment_Stage_0530_Item_00()
  Quest __temp = Self as Quest
  uc05_questscript kmyQuest = __temp as uc05_questscript
  Self.SetObjectiveCompleted(529, True)
  Self.SetObjectiveDisplayed(510, True, False)
  kmyQuest.IncrementIntercomState(1)
  kmyQuest.UpdateActiveIntercom(Self as ScriptObject, True, Alias_VaruunPowerSwitch03, 520)
  Alias_VEPowerSwitchEnableMarker03.GetRef().Enable(False)
EndFunction

Function Fragment_Stage_0538_Item_00()
  Alias_VenomTreeHaze_Group02.DisableAll(False)
EndFunction

Function Fragment_Stage_0539_Item_00()
  Alias_ThirdIntercom.ForceRefTo(Alias_ActiveIntercom.GetRef())
  UC05_539_ThirdIntercomTriggered.Start()
  Self.SetObjectiveDisplayed(510, False, False)
  Self.SetObjectiveDisplayed(539, True, False)
EndFunction

Function Fragment_Stage_0540_Item_00()
  Quest __temp = Self as Quest
  uc05_questscript kmyQuest = __temp as uc05_questscript
  Self.SetObjectiveCompleted(539, True)
  Self.SetObjectiveDisplayed(510, True, False)
  kmyQuest.UpdateActiveIntercom(Self as ScriptObject, True, Alias_VaruunPowerSwitch04, 520)
  Alias_VEPowerSwitchEnableMarker03.GetRef().Enable(False)
  If Self.GetStageDone(520)
    UC05_540_BalmorPowerBoxScene03.Start()
  EndIf
  WwiseEvent_OBJ_Server_Room_Light_Switch_Power_On.Play(Alias_VaruunPowerSwitch04.GetRef(), None, None)
  Utility.Wait(LightDelay)
  Int instance4 = WwiseEvent_OBJ_Server_Room_Power_On_A_Vent_LP.Play(Alias_VaruunPowerSwitch04.GetRef(), None, None)
  kmyQuest.RemoveHaze(2)
  Utility.Wait(VentDelay)
  wwiseevent.StopInstance(instance4)
EndFunction

Function Fragment_Stage_0550_Item_00()
  Quest __temp = Self as Quest
  uc05_questscript kmyQuest = __temp as uc05_questscript
  kmyQuest.IncrementIntercomState(1)
EndFunction

Function Fragment_Stage_0600_Item_00()
  Alias_VEMasterEnableMarker.GetRef().Enable(False)
EndFunction

Function Fragment_Stage_0650_Item_00()
  ObjectReference BaseDoorREF = Alias_VaruunBasementDoor.GetRef()
  BaseDoorREF.Unlock(False)
  UC05_Codin_LoopingIntercom.Stop()
  UC05_Codin_Warning.Start()
  Self.SetObjectiveCompleted(510, True)
  Self.SetObjectiveDisplayed(650, True, False)
  Alias_VaruunSHIVAs.SetUnconscious(False)
EndFunction

Function Fragment_Stage_0655_Item_00()
  Self.SetObjectiveCompleted(650, True)
  Self.SetObjectiveDisplayed(655, True, False)
EndFunction

Function Fragment_Stage_0700_Item_00()
  Actor CodinACT = Alias_Codin.GetActorRef()
  CodinACT.Enable(False)
  Alias_VaruunSafeRoomDoor.GetRef().Unlock(False)
  Self.SetObjectiveCompleted(650, True)
  Self.SetObjectiveCompleted(655, True)
  Self.SetObjectiveDisplayed(695, True, False)
  Actor[] myRobots = Alias_HostileAI.GetActorArray()
  Int I = 0
  While I < myRobots.Length
    myRobots[I].SetUnconscious(True)
    I += 1
  EndWhile
  Alias_PodRobot.GetActorRef().SetUnconscious(True)
  Alias_PrayerCircle01.GetActorRef().SetUnconscious(True)
  Alias_PrayerCircle02.GetActorRef().SetUnconscious(True)
  Alias_PrayerCircle03.GetActorRef().SetUnconscious(True)
  Alias_VaruunCodeMachine.GetRef().BlockActivation(True, False)
  Self.SetStage(701)
EndFunction

Function Fragment_Stage_0701_Item_00()
  Alias_Codin.GetActorRef().EvaluatePackage(False)
EndFunction

Function Fragment_Stage_0705_Item_00()
  Alias_IntercomSoundMarker.GetRef().Disable(False)
EndFunction

Function Fragment_Stage_0710_Item_00()
  UC05_Codin_Intro_Scene710.Start()
EndFunction

Function Fragment_Stage_0720_Item_00()
  Self.SetObjectiveCompleted(695, True)
  Self.SetObjectiveDisplayed(710, True, False)
  Alias_Codin.GetActorRef().EvaluatePackage(False)
EndFunction

Function Fragment_Stage_0725_Item_00()
  Self.SetObjectiveCompleted(700, True)
  Self.SetObjectiveDisplayed(725, True, False)
EndFunction

Function Fragment_Stage_0748_Item_00()
  Actor CodACT = Alias_Codin.GetActorRef()
  CodACT.AddtoFaction(PlayerEnemyFaction)
  CodACT.StartCombat(Game.GetPlayer() as ObjectReference, False)
EndFunction

Function Fragment_Stage_0749_Item_00()
  UC05_AndrejaBalmorDiscussedPlayer.SetValue(1.0)
EndFunction

Function Fragment_Stage_0780_Item_00()
  Self.SetObjectiveFailed(725, True)
  Self.SetObjectiveCompleted(730, True)
  Self.SetStage(800)
EndFunction

Function Fragment_Stage_0790_Item_00()
  If !Self.IsObjectiveCompleted(695)
    Self.SetObjectiveFailed(695, True)
  EndIf
  If !Self.IsObjectiveCompleted(700)
    Self.SetObjectiveFailed(700, True)
  EndIf
  If !Self.IsObjectiveCompleted(710)
    Self.SetObjectiveFailed(710, True)
  EndIf
  If !Self.IsObjectiveCompleted(725)
    Self.SetObjectiveFailed(725, True)
  EndIf
  If !Self.IsObjectiveCompleted(730)
    Self.SetObjectiveFailed(730, True)
  EndIf
  If !Self.IsObjectiveCompleted(790)
    Self.SetObjectiveDisplayed(790, True, False)
  EndIf
EndFunction

Function Fragment_Stage_0795_Item_00()
  Alias_VaruunCodeMachine.GetRef().PlayAnimation("Play01")
EndFunction

Function Fragment_Stage_0796_Item_00()
  Self.SetObjectiveCompleted(710, True)
  Self.SetObjectiveDisplayedAtTop(500)
  UC05_796_Balmor_CollectCodePiece.Start()
EndFunction

Function Fragment_Stage_0798_Item_00()
  Self.SetStage(799)
EndFunction

Function Fragment_Stage_0799_Item_00()
  Game.GetPlayer().AddItem(Alias_VaruunCodePiece.GetRef() as Form, 1, False)
  Self.SetObjectiveDisplayed(730, False, False)
  Self.SetStage(800)
  Self.SetStage(810)
  ObjectReference CompREF = Alias_Companion.GetRef()
  ObjectReference AndrejaREF = Alias_Andreja.GetRef()
  If CompREF != None && AndrejaREF != None && CompREF == AndrejaREF && CompREF.GetDistance(Game.GetPlayer() as ObjectReference) <= COM_InterjectionDistance.GetValue()
    UC05_AndrejaPresentForBalmorDiscussion.SetValue(1.0)
  EndIf
EndFunction

Function Fragment_Stage_0800_Item_00()
  Self.SetObjectiveCompleted(790, True)
  If !Self.GetStageDone(790)
    Self.SetObjectiveCompleted(710, True)
  EndIf
  If !Self.GetStageDone(799)
    Self.SetObjectiveCompleted(730, True)
    Self.SetObjectiveDisplayed(800, True, False)
  EndIf
  Alias_VaruunCodeMachine.GetRef().BlockActivation(False, False)
EndFunction

Function Fragment_Stage_0810_Item_00()
  Self.SetObjectiveCompleted(500, True)
  Self.SetObjectiveCompleted(800, True)
  Game.GetPlayer().AddItem(Alias_VaruunCodePiece.GetRef() as Form, 1, False)
  Alias_VaruunCodeMachine.GetRef().AddKeyword(BlockPlayerActivation)
  If Self.GetStageDone(450)
    Self.SetStage(900)
  EndIf
EndFunction

Function Fragment_Stage_0900_Item_00()
  Quest __temp = Self as Quest
  uc04_togglehallscreens kmyQuest = __temp as uc04_togglehallscreens
  Self.SetObjectiveDisplayed(900, True, False)
  pUC_NA_CL_PostTerrormorphAttackScene.SetStage(50)
EndFunction

Function Fragment_Stage_0915_Item_00()
  UC05_FreestarObserversAccepted.SetValue(1.0)
EndFunction

Function Fragment_Stage_0925_Item_00()
  Quest __temp = Self as Quest
  uc04_togglehallscreens kmyQuest = __temp as uc04_togglehallscreens
  Actor PlayACT = Game.GetPlayer()
  PlayACT.AddItem(UC05_ArmisticeArchiveAccessCard as Form, 1, False)
  PlayACT.AddItem(Alias_UCCodePiece.GetRef() as Form, 1, False)
  Self.SetObjectiveCompleted(900, True)
  Self.SetObjectiveDisplayed(925, True, False)
  kmyQuest.UpdateHallScreens(False)
EndFunction

Function Fragment_Stage_0930_Item_00()
  UC05_930_ArchiveScene.Start()
EndFunction

Function Fragment_Stage_0935_Item_00()
  Self.SetObjectiveCompleted(925, True)
  Self.SetObjectiveDisplayed(930, True, False)
EndFunction

Function Fragment_Stage_0940_Item_00()
  UC05_940_ArchiveMonitorInstructions.Start()
EndFunction

Function Fragment_Stage_0950_Item_00()
  Self.SetObjectiveCompleted(930, True)
  Self.SetObjectiveDisplayed(950, True, False)
  Alias_VaruunCodeReceptacle.GetRef().RemoveKeyword(BlockPlayerActivation)
  Alias_FreestarCodeReceptacle.GetRef().RemoveKeyword(BlockPlayerActivation)
  Alias_UCCodeReceptacle.GetRef().RemoveKeyword(BlockPlayerActivation)
EndFunction

Function Fragment_Stage_0952_Item_00()
  Game.GetPlayer().RemoveItem(Alias_UCCodePiece.GetRef() as Form, 1, False, None)
  If Self.GetStageDone(956) && Self.GetStageDone(954)
    Self.SetStage(960)
  EndIf
EndFunction

Function Fragment_Stage_0954_Item_00()
  Game.GetPlayer().RemoveItem(Alias_FreestarCodePiece.GetRef() as Form, 1, False, None)
  If Self.GetStageDone(952) && Self.GetStageDone(956)
    Self.SetStage(960)
  EndIf
EndFunction

Function Fragment_Stage_0956_Item_00()
  Game.GetPlayer().RemoveItem(Alias_VaruunCodePiece.GetRef() as Form, 1, False, None)
  If Self.GetStageDone(952) && Self.GetStageDone(954)
    Self.SetStage(960)
  EndIf
EndFunction

Function Fragment_Stage_0960_Item_00()
  Self.SetObjectiveCompleted(950, True)
  Self.SetObjectiveDisplayed(960, True, False)
  ObjectReference VaultDoorRef = Alias_AAVaultDoor.GetRef()
  WwiseEvent_QST_UC05_Unlock_Door_Success_Play.Play(VaultDoorRef, None, None)
  VaultDoorRef.Unlock(False)
  VaultDoorRef.Activate(Alias_UC02_DefenseSystem.GetRef(), False)
  UC05_960_CodesVerified.Start()
  Game.GetPlayer().SetValue(UC04_Foreknowledge_OpenedArchivesAV, 1.0)
EndFunction

Function Fragment_Stage_0965_Item_00()
  ObjectReference HadrianRef = Alias_Hadrian.GetRef()
  If HadrianRef.IsDisabled()
    HadrianRef.EnableNoWait(False)
  EndIf
  If HadrianRef.GetDistance(HadrianTeleportMarker) > 5.0
    HadrianRef.MoveTo(HadrianTeleportMarker, 0.0, 0.0, 0.0, True, False)
  EndIf
EndFunction

Function Fragment_Stage_0970_Item_00()
  Self.SetObjectiveCompleted(960, True)
  Self.SetObjectiveDisplayed(970, True, False)
  Game.GetPlayer().AddItem(Alias_TerrormorphData.GetRef() as Form, 1, False)
  ObjectReference HadrianRef = Alias_Hadrian.GetRef()
  HadrianRef.EnableNoWait(False)
  HadrianRef.MoveTo(HadrianTeleportMarker, 0.0, 0.0, 0.0, True, False)
  Alias_Cabinet18.GetRef().DisableNoWait(False)
EndFunction

Function Fragment_Stage_0972_Item_00()
  ObjectReference AADoor = Alias_AAVaultDoor.GetRef()
  Alias_AAVaultDoor.GetRef().SetOpen(False)
  AADoor.Lock(True, False, True)
EndFunction

Function Fragment_Stage_0975_Item_00()
  UC05_970_CodinHadrianAttract.Start()
EndFunction

Function Fragment_Stage_0980_Item_00()
  Self.SetObjectiveCompleted(970, True)
  Self.SetObjectiveDisplayed(980, True, False)
EndFunction

Function Fragment_Stage_0982_Item_00()
  Game.GetPlayer().RemoveItem(Alias_TerrormorphData.GetRef() as Form, 1, False, None)
EndFunction

Function Fragment_Stage_0985_Item_00()
  Alias_Hadrian.GetActorRef().EvaluatePackage(False)
  Self.SetStage(990)
EndFunction

Function Fragment_Stage_0990_Item_00()
  Alias_MAST_EmergencyDoor.GetRef().Lock(False, False, True)
  Alias_DeputyMacIntyre.GetActorRef().EvaluatePackage(False)
  Self.SetObjectiveCompleted(980, True)
  Self.SetObjectiveDisplayed(990, True, False)
EndFunction

Function Fragment_Stage_0997_Item_00()
  UC05_PlayerIsUCCitizen.SetValue(1.0)
  Actor PlayACT = Game.GetPlayer()
  PlayACT.AddItem(UC05_PlayerCitizenshipID01 as Form, 1, False)
  PlayACT.AddPerk(UC_CitizenVendorDiscount_Rank01, False)
  UC05_Realty_Misc.Start()
EndFunction

Function Fragment_Stage_1000_Item_00()
  If (UC05_PlayerCaughtSnoopingFSE.GetValue() >= 1.0 || Self.GetStageDone(449)) && !Self.GetStageDone(345) && !Self.GetStageDone(350)
    UC05_PlayerCausedIncident.SetValue(1.0)
  EndIf
  UC05_HadrianSandboxing_PostUC05.SetValue(1.0)
  Alias_HadrianShip_RHQ.GetRef().Enable(False)
  Game.GetPlayer().AddPerk(FactionUnitedColoniesPerk, False)
  Game.GetPlayer().RemoveItem(UC05_Freestar_ElevatorKey as Form, 1, True, None)
  UC06.Start()
  Self.CompleteAllObjectives()
  Self.Stop()
EndFunction
